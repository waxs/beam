"use strict";function _instanceof(left,right){if(right!=null&&typeof Symbol!=="undefined"&&right[Symbol.hasInstance]){return!!right[Symbol.hasInstance](left)}else{return left instanceof right}}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}
function _classCallCheck(instance,Constructor){if(!_instanceof(instance,Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
var Beam=function(){function Beam(el){var settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Beam);this._actions=[];this._el=el;this._hooks={};this._limit=settings.limit||10;this._settings=settings;this._init()}
    _createClass(Beam,[{key:"_name",value:function _name(el){return el.tagName.toLowerCase()}},{key:"_id",value:function _id(){return'_'+Math.random().toString(10).substr(2,9)}},{key:"_stamp",value:function _stamp(){return Math.floor(Date.now()/1000)}},{key:"_exe",value:function _exe(payload){return typeof payload!=='function'?payload:payload()}},{key:"_hasEvent",value:function _hasEvent(event){return event.hasOwnProperty('target')?'event':'static'}},{key:"_handleActionLimit",value:function _handleActionLimit(){if(this._actions.length>=this._limit)this._actions.pop()}},{key:"when",value:function when(name,callback){var delay=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this._create(name,callback,delay)}},{key:"once",value:function once(name,callback){var delay=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this._create(name,callback,delay,!0)}},{key:"event",value:function event(type,data){if(!this._el)return console.error('No argument was provided, to use this function pass either a DOM element or selector.');this._createEvent(type,data)}},{key:"_create",value:function _create(name,callback,delay){var once=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;this._createHook(name,callback,delay,once);this._createMethod(name,callback)}},{key:"_createHook",value:function _createHook(name,callback,delay,once){this._hooks[name]=!this._hooks[name]?[]:this._hooks[name];this._hooks[name].push({active:!0,type:'hook',id:this._id(),once:once,fn:callback,delay:delay})}},{key:"_createPayload",value:function _createPayload(){var obj={};for(var _len=arguments.length,data=new Array(_len),_key=0;_key<_len;_key++){data[_key]=arguments[_key]}
        var args=data.filter(function(argument){return argument});for(var i=0;i<args.length;i++){var type=typeof args[i].type==='undefined'?'data':args[i].type;if(!args[i].target)obj[type]=args[i]}
        return obj}},{key:"_createMethod",value:function _createMethod(name,callback){var _this=this;if(!this[name])this[name]=function(event,data){_this._hooks[name].filter(function(hook){var source=event&&_this._hasEvent(event);var action=hook.active&&_this._createAction(name,source,hook);setTimeout(function(){var payload=_this._createPayload(data,event,action);var controller=event&&event.target?event:payload;hook.active&&hook.fn(controller,payload);if(hook.once)hook.active=!1},hook.delay)})}}},{key:"_createAction",value:function _createAction(name,source,callback){this._handleActionLimit();var action={type:'action',name:name,source:source,callback:callback,timestamp:this._stamp()};this._actions.unshift(action);return action}},{key:"_createEvent",value:function _createEvent(name,data){var _this2=this;this._el.addEventListener(name,function(e){_this2[name](e,data)})}},{key:"_removeEvent",value:function _removeEvent(name){this._el.removeEventListener(name,this[name])}},{key:"_setEl",value:function _setEl(){var el=this._el;if(typeof this._el==='string')this._el=document.querySelector(this._el);if(el&&!this._el)return console.error("Not a valid element given:",el)}},{key:"_init",value:function _init(){this._setEl()}},{key:"hook",set:function set(hook){!hook.name||!hook.callback&&console.log("Hook must contain a name and callback");this._create(hook.name,hook.callback)},get:function get(){return this._hooks}},{key:"setting",set:function set(setting){(typeof settings==="undefined"?"undefined":_typeof(settings))==='object'&&console.log("Setting must be of type object ".concat(_typeof(setting)," given"),setting);this._settings={...this._settings,...setting}},get:function get(){return this._settings}},{key:"actions",get:function get(){return this._actions}}]);return Beam}()